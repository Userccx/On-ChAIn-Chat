# Pinata é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

Pinata æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ IPFS Pinning æœåŠ¡ï¼Œæä¾›ï¼š
- âœ… **24/7 å…¨å¤©å€™å¯ç”¨æ€§** - ä¹°å®¶éšæ—¶å¯è®¿é—®å–å®¶çš„æ•°æ®
- âœ… **æ— éœ€æœ¬åœ°èŠ‚ç‚¹** - ä¸éœ€è¦è¿è¡Œ IPFS å®ˆæŠ¤è¿›ç¨‹
- âœ… **å…¨çƒ CDN åŠ é€Ÿ** - å¿«é€Ÿçš„æ•°æ®æ£€ç´¢
- âœ… **å…è´¹é¢åº¦** - 1GB å­˜å‚¨ + æ¯æœˆ 100 æ¬¡ pin

---

## ğŸš€ å¿«é€Ÿé…ç½®ï¼ˆ3 æ­¥å®Œæˆï¼‰

### æ­¥éª¤ 1: æ³¨å†Œ Pinata è´¦å·

1. è®¿é—® [https://app.pinata.cloud](https://app.pinata.cloud)
2. ç‚¹å‡» "Start Building" æ³¨å†Œ
3. éªŒè¯é‚®ç®±å®Œæˆæ³¨å†Œ

### æ­¥éª¤ 2: åˆ›å»º API Key

1. ç™»å½• Pinata Dashboard
2. è¿›å…¥ **Developers** â†’ **API Keys**
3. ç‚¹å‡» **+ New Key**
4. é…ç½®æƒé™ï¼ˆå‹¾é€‰ä»¥ä¸‹é€‰é¡¹ï¼‰ï¼š
   - âœ… `pinFileToIPFS`
   - âœ… `pinJSONToIPFS`
   - âœ… `unpin`
   - âœ… `pinList`ï¼ˆå¯é€‰ï¼‰
5. å¡«å†™ Key åç§°ï¼ˆå¦‚ "My App"ï¼‰
6. ç‚¹å‡» **Create Key**
7. **é‡è¦**ï¼šå¤åˆ¶ **JWT** ä»¤ç‰Œï¼ˆåªæ˜¾ç¤ºä¸€æ¬¡ï¼ï¼‰

![Pinata API Key Creation](https://docs.pinata.cloud/assets/images/api-key-creation.png)

### æ­¥éª¤ 3: é…ç½® .env æ–‡ä»¶

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºæˆ–ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# ============ Pinata IPFS é…ç½® ============
IPFS_PINNING_SERVICE=pinata
PINATA_JWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.xxxxx...

# ç½‘å…³é…ç½®ï¼ˆä½¿ç”¨ Pinata ä¸“ç”¨ç½‘å…³ï¼Œæ›´å¿«æ›´ç¨³å®šï¼‰
IPFS_GATEWAY=https://gateway.pinata.cloud/ipfs/
```

**å®Œæˆï¼** é‡å¯åç«¯æœåŠ¡å³å¯ä½¿ç”¨ Pinataã€‚

---

## ğŸ”§ è¯¦ç»†é…ç½®è¯´æ˜

### å®Œæ•´ .env ç¤ºä¾‹

```env
# ============ åº”ç”¨é…ç½® ============
DEBUG=True
USE_MOCK_SERVICES=False

# ============ IPFS/Pinata é…ç½® ============
# æœåŠ¡ç±»å‹ï¼š'pinata' (æ¨è), 'local' (æœ¬åœ°èŠ‚ç‚¹), 'none' (Mock)
IPFS_PINNING_SERVICE=pinata

# Pinata JWT Tokenï¼ˆæ¨èæ–¹å¼ï¼‰
PINATA_JWT=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySW5mb3JtYXRpb24iOnsiaWQiOiIxMjM0NTY3ODkwIn0sImlhdCI6MTUxNjIzOTAyMn0.xxxxxxxxxxxx

# å¤‡é€‰æ–¹å¼ï¼šAPI Key + Secretï¼ˆäºŒé€‰ä¸€å³å¯ï¼‰
# PINATA_API_KEY=your_api_key
# PINATA_SECRET_KEY=your_secret_key

# IPFS ç½‘å…³ï¼ˆç”¨äºç”Ÿæˆå¯è®¿é—®çš„ URLï¼‰
IPFS_GATEWAY=https://gateway.pinata.cloud/ipfs/

# ============ å…¶ä»–é…ç½® ============
OPENAI_API_KEY=sk-xxx
# ... å…¶ä»–é…ç½® ...
```

### é…ç½®é¡¹è¯´æ˜

| é…ç½®é¡¹ | å¿…éœ€ | è¯´æ˜ |
|--------|------|------|
| `IPFS_PINNING_SERVICE` | âœ… | è®¾ç½®ä¸º `pinata` |
| `PINATA_JWT` | âœ… | JWT Tokenï¼ˆæ¨èï¼‰ |
| `PINATA_API_KEY` | å¯é€‰ | API Keyï¼ˆå¤‡é€‰æ–¹å¼ï¼‰ |
| `PINATA_SECRET_KEY` | å¯é€‰ | API Secretï¼ˆé…åˆ API Key ä½¿ç”¨ï¼‰ |
| `IPFS_GATEWAY` | æ¨è | å»ºè®®ä½¿ç”¨ Pinata ç½‘å…³ |

---

## âœ… éªŒè¯é…ç½®

### æ–¹æ³• 1: æŸ¥çœ‹å¯åŠ¨æ—¥å¿—

å¯åŠ¨åç«¯åï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼š

```bash
python -m flask --app backend.main:app run --reload
```

æˆåŠŸé…ç½®ä¼šæ˜¾ç¤ºï¼š
```
âœ… Pinata service initialized successfully
   âœ“ Pinata authentication successful
```

å¤±è´¥ä¼šæ˜¾ç¤ºï¼š
```
âš ï¸ Pinata credentials not configured
   ğŸ’¡ To use Pinata, set PINATA_JWT in .env file
```

### æ–¹æ³• 2: è°ƒç”¨çŠ¶æ€ API

```bash
# è·å–å­˜å‚¨æœåŠ¡çŠ¶æ€ï¼ˆéœ€è¦å…ˆç™»å½•è·å– tokenï¼‰
curl http://127.0.0.1:5000/health
```

### æ–¹æ³• 3: æµ‹è¯•ä¸Šä¼ 

é€šè¿‡èŠå¤©æ¥å£å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œæ£€æŸ¥æ—¥å¿—æ˜¯å¦æ˜¾ç¤ºï¼š
```
ğŸ“Œ Uploaded to Pinata: QmXxx...
```

---

## ğŸ“Š æ•°æ®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Pinata å®Œæ•´æ•°æ®æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ç”¨æˆ·å‘é€æ¶ˆæ¯                                                           â”‚
â”‚       â”‚                                                                 â”‚
â”‚       â–¼                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚   åç«¯æœåŠ¡      â”‚                                                    â”‚
â”‚  â”‚   (Flask)       â”‚                                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚           â”‚                                                             â”‚
â”‚           â–¼                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  StorageService._upload_to_pinata()                             â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚  POST https://api.pinata.cloud/pinning/pinJSONToIPFS            â”‚   â”‚
â”‚  â”‚  {                                                               â”‚   â”‚
â”‚  â”‚    "pinataContent": { ...chat_data... },                        â”‚   â”‚
â”‚  â”‚    "pinataMetadata": { "name": "chat_xxx_20251128" }            â”‚   â”‚
â”‚  â”‚  }                                                               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                                                             â”‚
â”‚           â–¼                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Pinata Cloud                                  â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   ğŸ“Œ æ•°æ®è¢«æ°¸ä¹…å­˜å‚¨å’Œ Pin                                       â”‚   â”‚
â”‚  â”‚   ğŸŒ é€šè¿‡å…¨çƒ CDN åˆ†å‘                                          â”‚   â”‚
â”‚  â”‚   â° 24/7 å¯ç”¨                                                   â”‚   â”‚
â”‚  â”‚                                                                  â”‚   â”‚
â”‚  â”‚   è¿”å›: { "IpfsHash": "QmXxx123..." }                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                                                             â”‚
â”‚           â–¼                                                             â”‚
â”‚  ä¹°å®¶å¯ä»¥éšæ—¶è®¿é—®:                                                      â”‚
â”‚  https://gateway.pinata.cloud/ipfs/QmXxx123...                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: JWT Token åœ¨å“ªé‡Œè·å–ï¼Ÿ

1. ç™»å½• [Pinata Dashboard](https://app.pinata.cloud)
2. è¿›å…¥ **Developers** â†’ **API Keys**
3. åˆ›å»ºæ–° Keyï¼Œå¤åˆ¶ **JWT** å­—æ®µ

### Q2: ä¸ºä»€ä¹ˆç”¨ JWT è€Œä¸æ˜¯ API Keyï¼Ÿ

- JWT æ›´å®‰å…¨ï¼ˆå•ä¸€ä»¤ç‰Œï¼‰
- JWT åŒ…å«æ‰€æœ‰æƒé™ä¿¡æ¯
- JWT æ›´å®¹æ˜“ç®¡ç†å’Œè½®æ¢

### Q3: å…è´¹é¢åº¦æ˜¯å¤šå°‘ï¼Ÿ

Pinata å…è´¹è®¡åˆ’åŒ…æ‹¬ï¼š
- 1 GB å­˜å‚¨ç©ºé—´
- æ¯æœˆ 100 æ¬¡ pin æ“ä½œ
- æ— é™æ¬¡è¯»å–

å¯¹äºå¼€å‘å’Œå°å‹åº”ç”¨è¶³å¤Ÿä½¿ç”¨ã€‚

### Q4: å¦‚ä½•æŸ¥çœ‹å·² pin çš„å†…å®¹ï¼Ÿ

1. ç™»å½• Pinata Dashboard
2. è¿›å…¥ **Files** é¡µé¢
3. å¯ä»¥çœ‹åˆ°æ‰€æœ‰ pinned çš„æ–‡ä»¶

### Q5: ä¸ºä»€ä¹ˆä¸Šä¼ å¤±è´¥ï¼Ÿ

**æ£€æŸ¥æ¸…å•ï¼š**
- [ ] `PINATA_JWT` æ˜¯å¦æ­£ç¡®è®¾ç½®ï¼Ÿ
- [ ] JWT Token æ˜¯å¦è¿‡æœŸï¼Ÿ
- [ ] API Key æƒé™æ˜¯å¦åŒ…å« `pinJSONToIPFS`ï¼Ÿ
- [ ] ç½‘ç»œæ˜¯å¦å¯ä»¥è®¿é—® api.pinata.cloudï¼Ÿ

**æŸ¥çœ‹è¯¦ç»†é”™è¯¯ï¼š**
```bash
tail -f logs/app_$(date +%Y%m%d).log | grep -i pinata
```

### Q6: æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œï¼Ÿ

- **Pinata äº‘æœåŠ¡å™¨** - ä¸»è¦å­˜å‚¨
- **IPFS å…¬å…±ç½‘ç»œ** - Pinata ä¼šå°†å†…å®¹å¹¿æ’­åˆ° IPFS ç½‘ç»œ
- **ä¹°å®¶å¯é€šè¿‡ä»»ä½• IPFS ç½‘å…³è®¿é—®**

---

## ğŸŒ ç½‘å…³é€‰æ‹©

| ç½‘å…³ | URL | ç‰¹ç‚¹ |
|------|-----|------|
| Pinata ä¸“ç”¨ | `https://gateway.pinata.cloud/ipfs/` | æœ€å¿«ï¼Œæ¨è |
| IPFS.io | `https://ipfs.io/ipfs/` | å…¬å…±ï¼Œå…è´¹ |
| Cloudflare | `https://cloudflare-ipfs.com/ipfs/` | ç¨³å®š |

**æ¨èé…ç½®ï¼š**
```env
IPFS_GATEWAY=https://gateway.pinata.cloud/ipfs/
```

---

## ğŸ“š ç›¸å…³é“¾æ¥

- [Pinata å®˜ç½‘](https://www.pinata.cloud/)
- [Pinata API æ–‡æ¡£](https://docs.pinata.cloud/)
- [Pinata Dashboard](https://app.pinata.cloud/)
- [IPFS å®˜æ–¹æ–‡æ¡£](https://docs.ipfs.tech/)

---

## âœ… é…ç½®æ£€æŸ¥æ¸…å•

- [ ] å·²æ³¨å†Œ Pinata è´¦å·
- [ ] å·²åˆ›å»º API Key å¹¶è·å– JWT
- [ ] å·²åœ¨ `.env` æ–‡ä»¶ä¸­è®¾ç½® `IPFS_PINNING_SERVICE=pinata`
- [ ] å·²åœ¨ `.env` æ–‡ä»¶ä¸­è®¾ç½® `PINATA_JWT=...`
- [ ] é‡å¯åç«¯æœåŠ¡
- [ ] éªŒè¯æ—¥å¿—æ˜¾ç¤º "Pinata service initialized successfully"
